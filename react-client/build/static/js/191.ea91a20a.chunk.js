"use strict";(self.webpackChunkreact_client=self.webpackChunkreact_client||[]).push([[191],{5191:function(e,r,n){n.r(r),n.d(r,{default:function(){return fe}});var t=n(7791),a=n(649),l=n(1026),s=n(3782),i=n(189),d=n(7135),o=n.n(d),c=n(6167),u=n(2618),x=n(6257),h=n(8757),m=n(1067),Z=n(9478),f=n(3017),j=n(1466),g=n(2574),b=n(599),p=n(9099),v=n(9597),y=n(1112),S=n(6755),C=n(7081),w=n(4593),O=n(7939),k=n(2547),A=n(2324),P=n(7454),I=n(7228),D=n(12),R=n(4379),E=n(4686),N=n(4935),L=n(168),z=n(9538),F=n(9554),M=n(1343),T=n(1404),U=n(720),V=n(4309),W=n(8517),B=n(2631),H=n(5063),_=n(2850),q=n(1166),G=n(6296),J=n(8654),K=n(6238),Q=n(4629),X=n(281),Y=n(5639),$=n(8161),ee=n(946),re=n(1e3),ne=n(7878),te=function(e){var r=e.orders,n=e.setOpen,t=e.setOrderId,a=e.setSelectedUser,s=e.setDeleteOrder,d=(0,c.useState)(0),o=(0,l.Z)(d,2),x=o[0],h=o[1];(0,c.useEffect)((function(){h(r.reduce((function(e,r){return e+parseFloat(r.value)}),0).toFixed(2))}),[r]);var m=(0,c.useCallback)((function(e){return"completed"===(e=e.toLowerCase())?"#7fff00":"pending"===e||"onHold"===e?"#fcc425":"failed"===e||"refunded"===e?"#d23030":"created"===e?"#aecad6":"#039be5"}),[]);return(0,ne.jsx)(ne.Fragment,{children:(0,ne.jsx)(H.Z,{children:(0,ne.jsxs)(_.Z,{children:[(0,ne.jsx)(q.Z,{children:(0,ne.jsx)(y.Z,(0,i.Z)((0,i.Z)({in:0!==r.length,style:{transformOrigin:"0 0 0"}},0!==r.length?{timeout:1e3}:{}),{},{children:(0,ne.jsxs)(G.Z,{children:[(0,ne.jsx)(J.Z,{children:"Order Id"}),(0,ne.jsx)(J.Z,{children:"Order Date"}),(0,ne.jsx)(J.Z,{children:"User"}),(0,ne.jsx)(J.Z,{children:"Service"}),(0,ne.jsx)(J.Z,{sx:{textAlign:"end"},children:"Order Value"}),(0,ne.jsx)(J.Z,{sx:{textAlign:"end"},children:"Order Status"}),(0,ne.jsx)(J.Z,{sx:{textAlign:"end"},children:"Payment Status"}),(0,ne.jsx)(J.Z,{sx:{textAlign:"end"},children:"Order Actions"})]})}))}),(0,ne.jsxs)(K.Z,{children:[r.map((function(e,r){return(0,ne.jsx)(c.Fragment,{children:(0,ne.jsxs)(G.Z,{children:[(0,ne.jsx)(J.Z,{children:e.id}),(0,ne.jsxs)(J.Z,{children:[(0,ne.jsx)("small",{children:(0,u.Z)(new Date(e.createdAt),"E h:mmaaa")}),(0,ne.jsx)("br",{}),(0,u.Z)(new Date(e.createdAt),"do MMMM")]}),(0,ne.jsxs)(J.Z,{children:[e.username,(0,ne.jsx)("br",{}),(0,ne.jsx)("small",{children:e.email})]}),(0,ne.jsx)(J.Z,{children:e.title}),(0,ne.jsxs)(J.Z,{sx:{textAlign:"end"},children:[new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e.value)," "]}),(0,ne.jsx)(J.Z,{sx:{textAlign:"end"},children:(0,ne.jsx)(Q.Z,{label:e.orderStatus,style:{backgroundColor:"".concat(m(e.orderStatus))},size:"small"})}),(0,ne.jsx)(J.Z,{sx:{textAlign:"end"},children:(0,ne.jsx)(X.Z,{onClick:function(){e.paymentStatus||(a(e.email),s(!1),t(e.id),n(!0))},sx:{borderRadius:"10px",boxShadow:e.paymentStatus?"none":"rgba(0, 0, 0, 0.24) 0px 3px 8px"},children:(0,ne.jsx)(Q.Z,{label:e.paymentStatus?"Paid":"unpaid",style:{backgroundColor:e.paymentStatus?"".concat(m("completed")):"".concat(m("failed"))},size:"small"})})}),(0,ne.jsxs)(J.Z,{sx:{textAlign:"end"},children:[(0,ne.jsx)(p.Z,{onClick:function(r){t(e.id),s(!0),n(!0)},size:"small",sx:{backgroundColor:"white",color:"red",mx:1,boxShadow:2},children:(0,ne.jsx)(Y.Z,{fontSize:"10px"})}),(0,ne.jsx)(p.Z,{component:re.rU,to:"/dashboard/admin/invoice/".concat(e.id),size:"small",sx:{backgroundColor:"white",color:"#07c6f8",mx:1,boxShadow:2},children:(0,ne.jsx)($.Z,{fontSize:"10px"})})]})]})},(0,ee.Z)())})),(0,ne.jsxs)(G.Z,{children:[(0,ne.jsx)(J.Z,{children:(0,ne.jsx)("b",{style:{color:"#1976d2"},children:"Total Order Value"})}),(0,ne.jsx)(J.Z,{children:(0,ne.jsxs)("b",{style:{color:"#1976d2"},children:[new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(x)," ","\u20b9"]})})]})]})]})})})},ae=n(9945),le=n(4974),se=n(1136),ie=n(5304),de=n(3400);var oe=function(){var e=(0,de.s0)();return(0,ne.jsxs)(g.ZP,{container:!0,spacing:2,justifyContent:"start",children:[(0,ne.jsx)(g.ZP,{item:!0,xs:12,children:(0,ne.jsxs)(k.Z,{children:[(0,ne.jsx)(ae.Z,{id:"order-actions",style:{color:"black"},children:(0,ne.jsx)("b",{children:"ORDER ACTIONS"})}),(0,ne.jsxs)(le.Z,{row:!0,"aria-labelledby":"order-actions",name:"order-actions",defaultValue:"edit-order",onChange:function(r){e(r.target.value)},children:[(0,ne.jsx)(se.Z,{value:"new-order",control:(0,ne.jsx)(ie.Z,{}),label:"New Order"}),(0,ne.jsx)(se.Z,{value:"edit-order",control:(0,ne.jsx)(ie.Z,{}),label:"Edit Order"}),(0,ne.jsx)(se.Z,{value:"refund-order",control:(0,ne.jsx)(ie.Z,{}),label:"Refund Order"}),(0,ne.jsx)(se.Z,{value:"send-payment-link",control:(0,ne.jsx)(ie.Z,{}),label:"Send Payment Link"})]})]})}),(0,ne.jsx)(de.j3,{})]})},ce=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=(0,c.useState)(e),t=(0,l.Z)(n,2),a=t[0],s=t[1];return(0,c.useEffect)((function(){var n;return n=setTimeout((function(){s(e)}),r),function(){clearTimeout(n)}}),[e,r]),a},ue=["children","value","index"],xe=(0,x.ZP)(f.Z)((function(e){var r=e.theme;return(0,i.Z)((0,i.Z)({backgroundColor:"dark"===r.palette.mode?"#1A2027":"#fff"},r.typography.body2),{},{padding:r.spacing(2),textAlign:"center",color:r.palette.text.secondary})}));function he(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}function me(e){var r=e.children,n=e.value,t=e.index,a=(0,s.Z)(e,ue);return(0,ne.jsx)("div",(0,i.Z)((0,i.Z)({role:"tabpanel",hidden:n!==t,id:"simple-tabpanel-".concat(t),"aria-labelledby":"simple-tab-".concat(t)},a),{},{children:n===t&&(0,ne.jsx)(j.Z,{sx:{p:3},children:r})}))}var Ze=function(e,r){return console.log(r),"price"===r?e.sort((function(e,r){return e.value>=r.value?-1:1})):"createdAt"===r?e.sort((function(e,r){return e.createdAt>=r.createdAt?-1:1})):"username"===r?e.sort((function(e,r){return e.username.toLowerCase()>=r.username.toLowerCase()?1:-1})):e.sort((function(e,r){return e.email.toLowerCase()>=r.email.toLowerCase()?1:-1}))},fe=function(){var e=(0,c.useContext)(h.Z),r=(0,T.Z)(),n=(0,c.useState)([]),s=(0,l.Z)(n,2),d=s[0],x=s[1],f=(0,c.useState)([]),H=(0,l.Z)(f,2),_=H[0],q=H[1],G=(0,c.useState)(!1),J=(0,l.Z)(G,2),K=J[0],Q=J[1],X=(0,c.useState)(0),Y=(0,l.Z)(X,2),$=Y[0],ee=Y[1],re=(0,c.useState)(0),ae=(0,l.Z)(re,2),le=ae[0],se=ae[1],ie=(0,c.useState)(""),de=(0,l.Z)(ie,2),ue=de[0],fe=de[1],je=(0,c.useState)("none"),ge=(0,l.Z)(je,2),be=ge[0],pe=ge[1],ve=(0,c.useState)(""),ye=(0,l.Z)(ve,2),Se=ye[0],Ce=ye[1],we=(0,c.useState)(!1),Oe=(0,l.Z)(we,2),ke=Oe[0],Ae=Oe[1],Pe=(0,M.Z)(r.breakpoints.down("md")),Ie=(0,c.useState)(""),De=(0,l.Z)(Ie,2),Re=De[0],Ee=De[1],Ne=ce(Re,2e3),Le=(0,c.useState)(""),ze=(0,l.Z)(Le,2),Fe=ze[0],Me=ze[1],Te=e.useAxiosPrivate(),Ue=(0,c.useRef)(!0);(0,c.useEffect)((function(){if(Ue.current)Ue.current=!1;else{var e=function(e,r){var n;if(r&&0!==e.length&&e&&(r.match(/^un (.+)/i)?(n="username",r=r.split(" ")[1]):r.match(/^od (.+)/i)?(n="orderDescription",r=r.split(" ")[1]):r.match(/^on (.+)/i)?(n="orderNotes",r=r.split(" ")[1]):r.match(/^em (.*)/i)?(n="email",r=r.split(" ")[1]):r.match(/^st (.+)/i)&&(n="title",r=r.split(" ")[1]),n))return r=r.toLowerCase(),e.filter((function(e){return!!e[n].toLowerCase().includes(r)}))}(d,Ne);(null===e||void 0===e?void 0:e.length)>0?q((0,a.Z)(e)):Ee("")}}),[d,Ne]);var Ve=(0,c.useCallback)(function(){var e=(0,t.Z)(o().mark((function e(r){var n,t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Z.Am.loading("fetching data"),e.prev=1,e.next=4,Te.get("/orders/downloads/".concat(r));case 4:t=e.sent,Me(URL.createObjectURL(new Blob([JSON.stringify(t.data)],{type:"application/json"}))),Z.Am.update(n,{render:"Data fetched successfully",type:"success",isLoading:!1,autoClose:1500}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),Z.Am.update(n,{render:e.t0.response?e.t0.response.data:"Server unavailable,try again later",type:e.t0.response?"warning":"error",isLoading:!1,autoClose:1500});case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(r){return e.apply(this,arguments)}}(),[Te]),We=(0,c.useCallback)((function(){Z.Am.promise(Te.post("/payments/send-payment-reminder",{orderId:$,email:ue}),{pending:"Processing request",error:"An error occurred",success:"Payment reminder sent"},[ue])}),[Te,ue,$]),Be=(0,c.useCallback)((function(e){if("none"!==e){var r;"paid"===e||"unpaid"===e?(r="paid"===e?{paymentStatus:!0}:{paymentStatus:!1},console.log("\ud83d\ude80 ~ file: Orders.js ~ line 171 ~ Orders ~ criteria",r)):r={orderStatus:e};Te.get("/orders/getorders",{params:r}).then((function(e){var r=e.data;0!==r.length?q(r):Z.Am.warn("No orders found for the given criteria")})).catch((function(e){}))}}),[Te]);return(0,c.useEffect)((function(){var e=new AbortController;return Te.get("/orders/getorders",{signal:e.signal}).then((function(e){var r=e.data;x((function(e){return[].concat((0,a.Z)(e),(0,a.Z)(r))}))})).catch((function(e){console.error(e)})),function(){e.abort()}}),[Te]),(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsxs)(g.ZP,{container:!0,columnSpacing:{md:1},rowSpacing:2,direction:"row",justifyContent:"space-around",alignItems:"center",children:[(0,ne.jsx)(b.Z,{in:!0,direction:"left",timeout:2e3,children:(0,ne.jsx)(g.ZP,{item:!0,xs:12,sm:9,md:4,lg:3,children:(0,ne.jsxs)(xe,{style:{backgroundColor:"#045de9",backgroundImage:"linear-gradient(315deg, #045de9 0%, #09c6f9 74%)"},children:[(0,ne.jsx)(p.Z,{sx:{backgroundColor:"#fbb034",backgroundImage:"linear-gradient(315deg, #fbb034 0%, #ffdd00 74%)",p:2,mb:2},children:(0,ne.jsx)(m.Z,{titleAccess:"Pending Orders",fontSize:"large",children:(0,ne.jsx)(V.r,{})})}),(0,ne.jsx)(v.Z,{variant:"h6",color:"#ff9f00",children:"PENDING ORDERS"}),(0,ne.jsx)(v.Z,{variant:"button",color:"#ff9f00",children:d.filter((function(e){return"pending"===e.orderStatus})).length})]})})}),(0,ne.jsx)(b.Z,{in:!0,direction:"down",timeout:2e3,children:(0,ne.jsx)(g.ZP,{item:!0,xs:12,sm:9,md:4,lg:3,children:(0,ne.jsxs)(xe,{style:{backgroundColor:"#045de9",backgroundImage:"linear-gradient(315deg, #045de9 0%, #09c6f9 74%)"},children:[(0,ne.jsx)(p.Z,{sx:{backgroundColor:"#fbb034",backgroundImage:"linear-gradient(315deg, #b8d3fe 0%, #aecad6 74%)",p:2,mb:2},children:(0,ne.jsx)(m.Z,{titleAccess:"Pending Orders",fontSize:"large",children:(0,ne.jsx)(W.r,{})})}),(0,ne.jsx)(v.Z,{variant:"h6",color:"#aecad6",children:"TOTAL ORDERS"}),(0,ne.jsx)(v.Z,{variant:"button",color:"#aecad6",children:d.length})]})})}),(0,ne.jsx)(b.Z,{in:!0,direction:"right",timeout:2e3,children:(0,ne.jsx)(g.ZP,{item:!0,xs:12,sm:9,md:4,lg:3,children:(0,ne.jsxs)(xe,{style:{backgroundColor:"#045de9",backgroundImage:"linear-gradient(315deg, #045de9 0%, #09c6f9 74%)"},children:[(0,ne.jsx)(p.Z,{"aria-label":"order-status-icon",sx:{backgroundColor:"#84fb95",backgroundImage:"linear-gradient(315deg, #98de5b 0%, #08e1ae 74%)",p:2,mb:2},children:(0,ne.jsx)(m.Z,{titleAccess:"Pending Orders",fontSize:"large",children:(0,ne.jsx)(U.r,{})})}),(0,ne.jsx)(v.Z,{variant:"h6",color:"#7fff00",children:"COMPLETE ORDERS"}),(0,ne.jsx)(v.Z,{variant:"button",color:"#7fff00",children:d.filter((function(e){return"completed"===e.orderStatus})).length})]})})})]}),(0,ne.jsx)(y.Z,{in:0!==d.length,timeout:2e3,children:(0,ne.jsx)(g.ZP,{container:!0,my:4,children:(0,ne.jsx)(g.ZP,{item:!0,lg:12,children:(0,ne.jsxs)(xe,{style:{backgroundColor:"#e7eff9",backgroundImage:"linear-gradient(315deg, #e7eff9 0%, #cfd6e6 74%)"},children:[(0,ne.jsx)(j.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,ne.jsxs)(S.Z,{value:le,onChange:function(e,r){se(r)},"aria-label":"Orders Tab",centered:!0,children:[(0,ne.jsx)(C.Z,(0,i.Z)({label:"All Orders"},he(0))),(0,ne.jsx)(C.Z,(0,i.Z)({label:"Order Actions"},he(1)))]})}),(0,ne.jsx)(me,{value:le,index:0,children:0!==d.length&&(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsxs)(w.Z,{direction:"column",justifyContent:"center",spacing:2,mx:"auto",children:[(0,ne.jsx)(g.ZP,{item:!0,lg:3,md:5,children:(0,ne.jsx)(O.Z,{size:"small",variant:"standard",type:"text",onChange:function(e){return Ee(e.target.value)},label:"Search orders",helperText:"Search by username, email, order description, order notes or service title. use keywords followed by your search term. Ex: 'un valerie, em abc@example.com, st gst service,od myOrderDescription, on myOrderNotes' "})}),(0,ne.jsx)(g.ZP,{item:!0,lg:3,md:5,children:(0,ne.jsxs)(k.Z,{fullWidth:!0,children:[(0,ne.jsx)(A.Z,{id:"status",children:"Filter by status"}),(0,ne.jsxs)(P.Z,{size:"small",variant:"standard",value:be,labelId:"status",defaultValue:"none",onChange:function(e){pe(e.target.value),"none"!==e.target.value&&(pe(e.target.value),Be(e.target.value))},label:"Filter by status",children:[(0,ne.jsx)(I.Z,{value:"none",children:"None"}),(0,ne.jsx)(D.Z,{children:"Order Status"}),(0,ne.jsx)(I.Z,{value:"onhold",children:"On Hold"}),(0,ne.jsx)(I.Z,{value:"pending",children:"Pending"}),(0,ne.jsx)(I.Z,{value:"refunded",children:"Refunded"}),(0,ne.jsx)(I.Z,{value:"completed",children:"Completed"}),(0,ne.jsx)(I.Z,{value:"failed",children:"Failed"}),(0,ne.jsx)(D.Z,{children:"Payment Status"}),(0,ne.jsx)(I.Z,{value:"paid",children:"Paid Orders"}),(0,ne.jsx)(I.Z,{value:"unpaid",children:"Unpaid Orders"})]})]})}),(0,ne.jsx)(g.ZP,{item:!0,lg:3,md:5,children:(0,ne.jsxs)(k.Z,{fullWidth:!0,children:[(0,ne.jsx)(A.Z,{id:"Sort",children:"Sort"}),(0,ne.jsxs)(P.Z,{size:"small",variant:"standard",value:Se,label:"Sort",labelId:"Sort",defaultValue:"createdAt",onChange:function(e){Ce(e.target.value),"none"!==be?(console.log("filtered orders being sorted"),q((function(r){return Ze(r,e.target.value)}))):(console.log("orders being sorted"),x((function(r){return Ze(r,e.target.value)})))},children:[(0,ne.jsx)(I.Z,{value:"price",children:"Order Value"}),(0,ne.jsx)(I.Z,{value:"createdAt",children:"Order Date"}),(0,ne.jsx)(I.Z,{value:"username",children:"Username"}),(0,ne.jsx)(I.Z,{value:"email",children:"Email"})]})]})}),(0,ne.jsx)(g.ZP,{item:!0,lg:3,md:5,children:(0,ne.jsxs)(k.Z,{fullWidth:!0,children:[(0,ne.jsx)(A.Z,{id:"Download monthly orders",children:"Download monthly orders report"}),(0,ne.jsx)(P.Z,{size:"small",variant:"standard",value:ue,label:"Download monthly orders",labelId:"Download monthly orders",onChange:function(e){Ve(e.target.value)},children:[0,1,2,3,4,5,6,7,8,9,10,11].map((function(e){return(0,ne.jsx)(I.Z,{value:e,children:(0,u.Z)(new Date(2022,e,1),"MMMM")},e)}))})]})})]}),(0,ne.jsx)(g.ZP,{container:!0,spacing:2,sx:{my:4},children:Fe&&(0,ne.jsx)(g.ZP,{item:!0,lg:3,children:(0,ne.jsx)(R.Z,{variant:"contained",href:Fe,component:"a",onClick:function(){Me("")},endIcon:(0,ne.jsx)(B.Z,{}),download:"MonthlyReport",children:"Download data"})})}),(0,ne.jsxs)(E.Z,{sx:{"& .MuiDialog-paper":{backgroundColor:"white",borderRadius:"1rem",paddingTop:"1rem"}},fullScreen:Pe,open:ke,onClose:function(){Ae(!1)},"aria-labelledby":"responsive-dialog-title",children:[(0,ne.jsx)(N.Z,{id:"responsive-dialog-title",sx:{color:"orange"},children:K?(0,ne.jsx)("b",{children:"Delete Order?"}):(0,ne.jsx)("b",{children:"Payment Reminder"})}),(0,ne.jsxs)(L.Z,{children:[ue&&!K&&(0,ne.jsxs)(z.Z,{children:["Are you sure you want to send a payment reminder to"," ",(0,ne.jsxs)("b",{style:{color:"black"},children:[ue&&ue,"?"]})]}),K&&(0,ne.jsxs)(z.Z,{children:["Are you sure you want to delete this order"," ",(0,ne.jsxs)("b",{style:{color:"black"},children:["#",$]}),"? Any associated review attached to this order will also be deleted"]})]}),(0,ne.jsxs)(F.Z,{children:[(0,ne.jsx)(R.Z,{color:"error",autoFocus:!0,onClick:function(){Ae(!1)},children:"Exit"}),(0,ne.jsx)(R.Z,{color:"success",onClick:K?function(){var e=Te.delete("/orders/delete-order/".concat($));Z.Am.promise(e,{pending:"deleting order...",success:"Order deleted successfully",error:"Order could not be delted"}).then((function(){var e=d.findIndex((function(e){return e.id===$}));x((function(r){return[].concat((0,a.Z)(r.slice(0,e)),(0,a.Z)(r.slice(e+1)))}))})),Ae(!1)}:We,autoFocus:!0,children:K?"Confirm":"Send Reminder"})]})]}),(0,ne.jsx)(te,{setDeleteOrder:Q,orders:Re||"none"!==be?_:d,setOpen:Ae,setOrderId:ee,setSelectedUser:fe})]})}),(0,ne.jsx)(me,{value:le,index:1,children:(0,ne.jsx)(oe,{})})]})})})})]})}}}]);
//# sourceMappingURL=191.ea91a20a.chunk.js.map